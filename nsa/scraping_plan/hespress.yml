article_links:
  description: scraping article links for each category provided as an input
  interactions:
    - do_once: visit_page
      description: visiting the home page for hespress
      inputs:
        url: "https://www.hespress.com/"
    - do_many: category
      description: here we will be scraping data for each category provided as an input
      for_each: "{categories_list}"
      interactions:
        - do_once: click
          inputs:
            selectors:
              - //a[@class='nav-link' and text()="{category}"]
        - do_once: scrape_page
          inputs:
            selectors:
              - //div[@class='cover']
            data_to_get:
              - kind: attribute
                relocate: //a
                name: title
                alias: title

              - kind: attribute
                relocate: //a//img
                name: src
                alias: image

              - kind: text
                relocate: //div[@class='card-body']//small
                alias: date

              - kind: attribute
                relocate: //a
                name: href
                alias: url

              - kind: text
                relocate: //span[@class[contains( ., 'cat')]]
                alias: category
test_do_until:
  description: retrieving most viewed articles on hespress
  interactions:
    - do_once: visit_page
      inputs:
        url: "https://www.hespress.com/all?most_viewed"

    - do_until: no_more
      condition:
        elements_selector: //div[@class='cover']//div[@class='card-body']//small
      interactions:
        - do_once: use_keyboard
          inputs:
            keys:
              - PageDown
        - do_once: wait_for
          inputs:
            selectors:
              - //div[@class="spinner-border"]
            state: detached
most_viewed:
  description: retrieving most viewed articles on hespress
  interactions:
    - do_once: visit_page
      inputs:
        url: "https://www.hespress.com/all?most_viewed"
    - do_many: articles
      for: 5
      interactions:
        - do_once: use_keyboard
          inputs:
            keys:
              - PageDown
    - do_once: scrape_page
      inputs:
        selectors:
          - //div[@class='cover']
        include_order: true
        data_to_get:
          - kind: attribute
            relocate: //a
            name: title
            alias: title

          - kind: attribute
            relocate: //a//img
            name: src
            alias: image

          - kind: text
            relocate: //div[@class='card-body']//small
            alias: date

          - kind: attribute
            relocate: //a
            name: href
            alias: url

          - kind: text
            relocate: //span[@class[contains( ., 'cat')]]
            alias: category
